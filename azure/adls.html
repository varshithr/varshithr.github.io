<!DOCTYPE html>
<html lang="en">
<head>
    <title>Azure Data Lake Storage (ADLS) Gen2 Deep Dive</title>
    <style>
        @media (max-width: 767px) {
            .responsive-table thead { display: none; }
            .responsive-table tbody, .responsive-table tr, .responsive-table td { display: block; width: 100%; }
            .responsive-table tr { margin-bottom: 1rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); background-color: white; }
            .responsive-table td { display: flex; justify-content: space-between; align-items: center; text-align: right; padding: 0.75rem 1rem; border-bottom: 1px solid #e5e7eb; }
            .responsive-table td::before { content: attr(data-label); text-align: left; font-weight: 600; color: #0072C6; padding-right: 1rem; white-space: nowrap; }
            .responsive-table td:last-child { border-bottom: none; }
        }
    </style>
    <script>
        const state = { currentTab: 'architecture' };
        const concepts = {
            architecture: {
                title: "1. Core Architecture: Hierarchical Namespace",
                description: "ADLS Gen2 is built on Azure Blob Storage but adds a hierarchical namespace, which is a key differentiator for analytics workloads.",
                headers: ["Concept", "Description", "Benefit for Analytics"],
                rows: [
                    { key: "Blob Storage Foundation", data: ["Provides low-cost, tiered storage and high availability", "Leverages mature features like lifecycle management and redundancy"] },
                    { key: "Hierarchical Namespace", data: ["Allows organizing objects into a true directory hierarchy", "Enables atomic directory manipulations and faster metadata operations"] },
                    { key: "ABFS Driver", data: ["Azure Blob File System driver for Hadoop compatibility", "Allows engines like Spark and Presto to interact with ADLS as a file system"] },
                ]
            },
            security: {
                title: "2. Security Model: RBAC and ACLs",
                description: "ADLS Gen2 provides a layered security model that combines role-based and fine-grained access controls.",
                headers: ["Mechanism", "Scope", "Use Case"],
                rows: [
                    { key: "Azure RBAC", data: ["Assign roles at the storage account or container level", "Granting broad permissions like 'Storage Blob Data Reader' to a group"] },
                    { key: "POSIX-like ACLs", data: ["Apply read/write/execute permissions to individual files and directories", "Granting a specific user write access to a single subdirectory"] },
                    { key: "Service Principals & Managed Identities", data: ["Azure AD identities for applications", "Allowing services like Data Factory or Databricks to securely access data"] },
                ]
            },
            tiers: {
                title: "3. Storage Tiers & Lifecycle Management",
                description: "ADLS Gen2 uses Azure Blob Storage tiers to optimize costs based on data access patterns.",
                headers: ["Tier", "Designed For", "Access Cost"],
                rows: [
                    { key: "Hot", data: ["Frequently accessed data", "Lowest access cost, highest storage cost"] },
                    { key: "Cool", data: ["Infrequently accessed data (stored for at least 30 days)", "Higher access cost, lower storage cost"] },
                    { key: "Archive", data: ["Long-term archival data (stored for at least 180 days)", "Highest access cost, lowest storage cost; data is offline"] },
                    { key: "Lifecycle Management", data: ["Automated policies to move data between tiers", "e.g., Move data from Hot to Cool after 90 days, then to Archive after a year"] },
                ]
            },
            performance: {
                title: "4. Performance Optimization",
                description: "Techniques to maximize throughput and minimize latency for large-scale analytics.",
                headers: ["Technique", "How It Works", "Impact"],
                rows: [
                    { key: "Partitioning", data: ["Organize data into directories based on common filter columns", "Allows query engines to prune data and avoid unnecessary scans"] },
                    { key: "Columnar Formats (Parquet/ORC)", data: ["Store data in columns instead of rows", "Massively reduces I/O for analytical queries"] },
                    { key: "Small File Compaction", data: ["Use tools like Spark to compact many small files into fewer large ones", "Reduces metadata overhead and improves read performance"] },
                ]
            }
        };
        const render = () => {
            const container = document.getElementById('table-container');
            const messageBar = document.getElementById('message-bar');
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(btn => {
                btn.classList.remove('bg-gray-700', 'text-white');
                btn.classList.add('bg-white', 'text-gray-700', 'hover:bg-gray-50');
                if (btn.dataset.tab === state.currentTab) {
                    btn.classList.remove('bg-white', 'text-gray-700', 'hover:bg-gray-50');
                    btn.classList.add('bg-gray-700', 'text-white', 'shadow-lg');
                }
            });
            messageBar.innerHTML = `<span class="font-bold">${concepts[state.currentTab].title}</span>: ${concepts[state.currentTab].description}`;
            const currentConcept = concepts[state.currentTab];
            let html = '<table class="w-full responsive-table shadow-xl rounded-xl overflow-hidden">';
            html += '<thead class="bg-blue-600 text-white"><tr>';
            currentConcept.headers.forEach(header => {
                html += `<th class="p-3 text-left font-semibold text-sm">${header}</th>`;
            });
            html += '</tr></thead>';
            html += '<tbody>';
            currentConcept.rows.forEach(row => {
                html += '<tr class="md:border-b md:border-gray-200">';
                html += `<td data-label="${currentConcept.headers[0]}" class="font-semibold text-blue-800 md:bg-blue-50">${row.key}</td>`;
                row.data.forEach((cellData, colIndex) => {
                    html += `<td data-label="${currentConcept.headers[colIndex + 1]}">${cellData}</td>`;
                });
                html += '</tr>';
            });
            html += '</tbody></table>';
            container.innerHTML = html;
        };
        const switchTab = (tabName) => {
            state.currentTab = tabName;
            render();
        };

        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', () => switchTab(button.dataset.tab));
            });
            switchTab('architecture');
        });
    </script>
</head>
<body class="antialiased" data-base-path=".." data-page-type="deep-dive" data-topic-name="Azure" data-topic-color="#0089D6">
    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="space-y-8">
            <div class="card" style="cursor: default;">
                <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-800 mb-4 flex items-center">
                    Azure Data Lake Storage (ADLS) Gen2
                </h1>
                <p class="text-base sm:text-lg text-gray-600 mb-8">A deep dive into ADLS Gen2, the massively scalable and secure data lake solution for high-performance analytics workloads on Azure.</p>
                <div class="flex flex-wrap gap-2 mb-8">
                    <button data-tab="architecture" class="tab-button py-2 px-3 text-sm sm:px-4 rounded-lg font-semibold border border-gray-700 transition duration-150 ease-in-out">1. Core Architecture</button>
                    <button data-tab="security" class="tab-button py-2 px-3 text-sm sm:px-4 rounded-lg font-semibold border border-gray-700 transition duration-150 ease-in-out">2. Security Model</button>
                    <button data-tab="tiers" class="tab-button py-2 px-3 text-sm sm:px-4 rounded-lg font-semibold border border-gray-700 transition duration-150 ease-in-out">3. Storage Tiers</button>
                    <button data-tab="performance" class="tab-button py-2 px-3 text-sm sm:px-4 rounded-lg font-semibold border border-gray-700 transition duration-150 ease-in-out">4. Performance</button>
                </div>
                <div id="message-bar" class="bg-blue-100 border-l-4 border-blue-500 text-blue-800 p-4 mb-8 rounded-md shadow-md text-sm sm:text-base"></div>
                <div id="table-container" class="mt-8"></div>
            </div>
        </div>
    </main>
    <script src="../js/main.js"></script>
</body>
</html>
