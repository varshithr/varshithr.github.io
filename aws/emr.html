<!DOCTYPE html>
<html lang="en">
<head>
    <title>Amazon EMR Deep Dive</title>
    <style>
        @media (max-width: 767px) {
            .responsive-table thead { display: none; }
            .responsive-table tbody, .responsive-table tr, .responsive-table td { display: block; width: 100%; }
            .responsive-table tr { margin-bottom: 1rem; border: 1px solid #e5e7eb; border-radius: 0.5rem; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); background-color: white; }
            .responsive-table td { display: flex; justify-content: space-between; align-items: center; text-align: right; padding: 0.75rem 1rem; border-bottom: 1px solid #e5e7eb; }
            .responsive-table td::before { content: attr(data-label); text-align: left; font-weight: 600; color: #b98700; padding-right: 1rem; white-space: nowrap; }
            .responsive-table td:last-child { border-bottom: none; }
        }
    </style>
    <script>
        const state = { currentTab: 'architecture' };
        const concepts = {
            architecture: {
                title: "1. EMR Cluster Architecture",
                description: "EMR provisions managed clusters of EC2 instances, with different node types serving specific roles.",
                headers: ["Node Type", "Function", "Key Characteristic"],
                rows: [
                    { key: "Master Node", data: ["Coordinates the cluster, runs YARN ResourceManager, Spark Master", "Single point of failure; can be deployed in a multi-master config for HA"] },
                    { key: "Core Nodes", data: ["Run data processing tasks and store data in HDFS", "Cannot be removed from a running cluster; provides storage"] },
                    { key: "Task Nodes", data: ["Provide additional compute capacity for tasks", "Can be added/removed to scale; does not store data in HDFS"] },
                ]
            },
            frameworks: {
                title: "2. Supported Frameworks",
                description: "EMR is a versatile platform that supports a wide range of open-source big data frameworks.",
                headers: ["Framework", "Primary Use Case", "Notes"],
                rows: [
                    { key: "Apache Spark", data: ["General-purpose ETL, ML, and interactive analytics", "The most common framework used on EMR"] },
                    { key: "Apache Hadoop", data: ["Batch processing with MapReduce", "Legacy framework, often used for lift-and-shift workloads"] },
                    { key: "Apache Flink", data: ["High-throughput, low-latency stateful stream processing", "Ideal for complex event processing"] },
                    { key: "Presto / Trino", data: ["Distributed SQL query engine for interactive analytics", "Used for ad-hoc querying on data in S3"] },
                ]
            },
            storage: {
                title: "3. Storage and EMRFS",
                description: "EMR decouples compute and storage by using the EMR File System (EMRFS) to interact with Amazon S3.",
                headers: ["Concept", "Description", "Benefit"],
                rows: [
                    { key: "EMRFS", data: ["A connector that allows Hadoop/Spark to use S3 as a storage layer", "Enables ephemeral (transient) clusters, as data persists in S3"] },
                    { key: "S3-backed Storage", data: ["Data is read from and written to S3 directly", "Decouples compute and storage, allowing independent scaling"] },
                    { key: "HDFS", data: ["Hadoop's distributed file system, runs on Core nodes", "Provides data locality for performance, but couples storage and compute"] },
                    { key: "Consistent View", data: ["An EMRFS feature that checks for S3 read-after-write consistency", "Helps prevent errors in ETL workflows caused by S3's eventual consistency"] },
                ]
            },
            deployment: {
                title: "4. Deployment Models",
                description: "EMR offers different deployment models to suit various use cases and operational preferences.",
                headers: ["Model", "Description", "Best For"],
                rows: [
                    { key: "EMR on EC2", data: ["The traditional model where you manage a cluster of EC2 instances", "Maximum control over configuration, long-running jobs"] },
                    { key: "EMR on EKS", data: ["Run EMR applications on an Amazon EKS (Kubernetes) cluster", "Standardizing on Kubernetes, consolidating application management"] },
                    { key: "EMR Serverless", data: ["A fully serverless option that abstracts away cluster management", "Intermittent or unpredictable workloads, ease of use"] },
                ]
            },
            cost: {
                title: "5. Cost Optimization",
                description: "Several features allow you to significantly reduce the cost of running EMR workloads.",
                headers: ["Feature", "How It Works", "Potential Savings"],
                rows: [
                    { key: "EC2 Spot Instances", data: ["Use spare EC2 capacity at a significant discount", "Up to 90% savings for fault-tolerant workloads"] },
                    { key: "Managed Scaling", data: ["Automatically resizes the cluster based on YARN metrics", "Avoids paying for idle resources"] },
                    { key: "Ephemeral Clusters", data: ["Launch a cluster for a specific job and terminate it when done", "Pay only for the exact compute time needed"] },
                ]
            }
        };
        const render = () => {
            const container = document.getElementById('table-container');
            const messageBar = document.getElementById('message-bar');
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(btn => {
                btn.classList.remove('bg-gray-700', 'text-white');
                btn.classList.add('bg-white', 'text-gray-700', 'hover:bg-gray-50');
                if (btn.dataset.tab === state.currentTab) {
                    btn.classList.remove('bg-white', 'text-gray-700', 'hover:bg-gray-50');
                    btn.classList.add('bg-gray-700', 'text-white', 'shadow-lg');
                }
            });
            messageBar.innerHTML = `<span class="font-bold">${concepts[state.currentTab].title}</span>: ${concepts[state.currentTab].description}`;
            const currentConcept = concepts[state.currentTab];
            let html = '<table class="w-full responsive-table shadow-xl rounded-xl overflow-hidden">';
            html += '<thead class="bg-yellow-500 text-gray-800"><tr>';
            currentConcept.headers.forEach(header => {
                html += `<th class="p-3 text-left font-semibold text-sm">${header}</th>`;
            });
            html += '</tr></thead>';
            html += '<tbody>';
            currentConcept.rows.forEach(row => {
                html += '<tr class="md:border-b md:border-gray-200">';
                html += `<td data-label="${currentConcept.headers[0]}" class="font-semibold text-yellow-800 md:bg-yellow-50">${row.key}</td>`;
                row.data.forEach((cellData, colIndex) => {
                    html += `<td data-label="${currentConcept.headers[colIndex + 1]}">${cellData}</td>`;
                });
                html += '</tr>';
            });
            html += '</tbody></table>';
            container.innerHTML = html;
        };
        const switchTab = (tabName) => {
            state.currentTab = tabName;
            render();
        };

        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.tab-button').forEach(button => {
                button.addEventListener('click', () => switchTab(button.dataset.tab));
            });
            switchTab('architecture');
        });
    </script>
</head>
<body class="antialiased" data-base-path=".." data-page-type="deep-dive" data-topic-name="AWS" data-topic-color="#FF9900">
    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="space-y-8">
            <div class="card" style="cursor: default;">
                <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-800 mb-4 flex items-center">
                    Amazon EMR: Big Data Processing at Scale
                </h1>
                <p class="text-base sm:text-lg text-gray-600 mb-8">A deep dive into Amazon EMR (Elastic MapReduce), the managed cloud platform for running large-scale data processing applications.</p>
                <div class="flex flex-wrap gap-2 mb-8">
                    <button data-tab="architecture" class="tab-button py-2 px-3 text-sm sm:px-4 rounded-lg font-semibold border border-gray-700 transition duration-150 ease-in-out">1. Cluster Architecture</button>
                    <button data-tab="frameworks" class="tab-button py-2 px-3 text-sm sm:px-4 rounded-lg font-semibold border border-gray-700 transition duration-150 ease-in-out">2. Frameworks</button>
                    <button data-tab="storage" class="tab-button py-2 px-3 text-sm sm:px-4 rounded-lg font-semibold border border-gray-700 transition duration-150 ease-in-out">3. Storage & EMRFS</button>
                    <button data-tab="deployment" class="tab-button py-2 px-3 text-sm sm:px-4 rounded-lg font-semibold border border-gray-700 transition duration-150 ease-in-out">4. Deployment Models</button>
                    <button data-tab="cost" class="tab-button py-2 px-3 text-sm sm:px-4 rounded-lg font-semibold border border-gray-700 transition duration-150 ease-in-out">5. Cost Optimization</button>
                </div>
                <div id="message-bar" class="bg-blue-100 border-l-4 border-blue-500 text-blue-800 p-4 mb-8 rounded-md shadow-md text-sm sm:text-base"></div>
                <div id="table-container" class="mt-8"></div>
            </div>
        </div>
    </main>
    <script src="../js/main.js"></script>
</body>
</html>
