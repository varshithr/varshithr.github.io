<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.tailwindcss.com"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
<style>
    body {
        font-family: 'Inter', sans-serif;
        background-color: #F0F4F8;
        color: #1E293B;
    }
    .card {
        background-color: white;
        border-radius: 0.75rem;
        padding: 1.5rem;
        box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.05), 0 4px 6px -4px rgb(0 0 0 / 0.05);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        display: flex;
        flex-direction: column;
        cursor: pointer; /* Added for clickable cards */
    }
    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
    }
    .card-content {
        flex-grow: 1;
    }
    .card-link {
        margin-top: auto;
        padding-top: 1rem;
    }
</style>
<title>Advanced SQL Techniques</title>
<style>
    body {
        font-family: 'Inter', sans-serif;
        background-color: #F0F4F8;
        color: #1E293B;
    }
    .card {
        background-color: white;
        border-radius: 0.75rem;
        padding: 1.5rem;
        box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.05), 0 4px 6px -4px rgb(0 0 0 / 0.05);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        display: flex;
        flex-direction: column;
        cursor: pointer; /* Added for clickable cards */
    }
    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
    }
    .card-content {
        flex-grow: 1;
    }
    .card-link {
        margin-top: auto;
        padding-top: 1rem;
    }
</style>

</head>
<body class="antialiased" data-base-path=".." data-page-type="deep-dive" data-topic-name="SQL" data-topic-color="#336791">
    <main class="container mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <div class="space-y-8">
            <div class="card" style="cursor: default;">
                <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-800 mb-4 flex items-center">
                    Advanced SQL Techniques: Beyond the Basics
                </h1>
                <p class="text-base sm:text-lg text-gray-600 mb-8">Master advanced SQL concepts including window functions, CTEs, and performance optimization strategies for complex data analysis.</p>
                
                <h2 class="text-2xl font-bold text-gray-800 mb-4 mt-8">1. Window Functions</h2>
                <p class="mb-4 text-gray-600">Powerful SQL functions that perform calculations across a set of rows related to the current row.</p>
                
                <div class="overflow-x-auto">
                    <table class="w-full responsive-table shadow-xl rounded-xl overflow-hidden">
                        <thead class="bg-blue-500 text-white">
                            <tr>
                                <th class="p-3 text-left font-semibold text-sm">Function Type</th>
                                <th class="p-3 text-left font-semibold text-sm">Purpose</th>
                                <th class="p-3 text-left font-semibold text-sm">Example Use Case</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Function Type" class="font-semibold text-blue-800 md:bg-blue-50">Ranking Functions</td>
                                <td data-label="Purpose">Assign ranks to rows (ROW_NUMBER, RANK, DENSE_RANK)</td>
                                <td data-label="Example Use Case">Top-N queries, leaderboards, ranking analysis</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Function Type" class="font-semibold text-blue-800 md:bg-blue-50">Aggregate Functions</td>
                                <td data-label="Purpose">Running totals, moving averages, cumulative calculations</td>
                                <td data-label="Example Use Case">Sales trends, moving averages, YTD calculations</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Function Type" class="font-semibold text-blue-800 md:bg-blue-50">Value Functions</td>
                                <td data-label="Purpose">Access values from other rows (LAG, LEAD, FIRST_VALUE)</td>
                                <td data-label="Example Use Case">Period-over-period comparisons, filling gaps</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Function Type" class="font-semibold text-blue-800 md:bg-blue-50">Distribution Functions</td>
                                <td data-label="Purpose">Percentiles, quartiles, and relative ranking</td>
                                <td data-label="Example Use Case">Performance percentiles, quartile analysis</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h2 class="text-2xl font-bold text-gray-800 mb-4 mt-8">2. Common Table Expressions (CTEs)</h2>
                <p class="mb-4 text-gray-600">Temporary named result sets that improve query readability and enable complex recursive queries.</p>
                
                <div class="overflow-x-auto">
                    <table class="w-full responsive-table shadow-xl rounded-xl overflow-hidden">
                        <thead class="bg-blue-500 text-white">
                            <tr>
                                <th class="p-3 text-left font-semibold text-sm">Type</th>
                                <th class="p-3 text-left font-semibold text-sm">Description</th>
                                <th class="p-3 text-left font-semibold text-sm">Benefits</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Type" class="font-semibold text-blue-800 md:bg-blue-50">Non-Recursive CTE</td>
                                <td data-label="Description">Simple named query blocks for complex logic decomposition</td>
                                <td data-label="Benefits">Improved readability, modularity, debugging</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Type" class="font-semibold text-blue-800 md:bg-blue-50">Recursive CTE</td>
                                <td data-label="Description">Queries that reference themselves for hierarchical data</td>
                                <td data-label="Benefits">Tree traversal, organizational charts, bill of materials</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Type" class="font-semibold text-blue-800 md:bg-blue-50">Multiple CTEs</td>
                                <td data-label="Description">Multiple named blocks in a single query</td>
                                <td data-label="Benefits">Breaking complex queries into logical steps</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Type" class="font-semibold text-blue-800 md:bg-blue-50">CTE with Column Names</td>
                                <td data-label="Description">Explicitly naming columns in CTE definition</td>
                                <td data-label="Benefits">Clear documentation, error prevention</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h2 class="text-2xl font-bold text-gray-800 mb-4 mt-8">3. Performance Optimization Techniques</h2>
                <p class="mb-4 text-gray-600">Advanced strategies for optimizing SQL query performance and reducing execution time.</p>
                
                <div class="overflow-x-auto">
                    <table class="w-full responsive-table shadow-xl rounded-xl overflow-hidden">
                        <thead class="bg-blue-500 text-white">
                            <tr>
                                <th class="p-3 text-left font-semibold text-sm">Technique</th>
                                <th class="p-3 text-left font-semibold text-sm">Approach</th>
                                <th class="p-3 text-left font-semibold text-sm">Performance Impact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Technique" class="font-semibold text-blue-800 md:bg-blue-50">Index Optimization</td>
                                <td data-label="Approach">Creating appropriate indexes on frequently queried columns</td>
                                <td data-label="Performance Impact">Dramatically faster SELECT operations</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Technique" class="font-semibold text-blue-800 md:bg-blue-50">Query Restructuring</td>
                                <td data-label="Approach">Rewriting queries to be more efficient (e.g., EXISTS vs IN)</td>
                                <td data-label="Performance Impact">Reduced execution time and resource usage</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Technique" class="font-semibold text-blue-800 md:bg-blue-50">Partitioning</td>
                                <td data-label="Approach">Splitting large tables into smaller, more manageable pieces</td>
                                <td data-label="Performance Impact">Faster queries through partition elimination</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Technique" class="font-semibold text-blue-800 md:bg-blue-50">Subquery Optimization</td>
                                <td data-label="Approach">Converting correlated subqueries to JOINs where possible</td>
                                <td data-label="Performance Impact">Significant improvement for complex nested queries</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h2 class="text-2xl font-bold text-gray-800 mb-4 mt-8">4. Advanced JOIN Patterns</h2>
                <p class="mb-4 text-gray-600">Complex JOIN scenarios and patterns for handling challenging data relationships.</p>
                
                <div class="overflow-x-auto">
                    <table class="w-full responsive-table shadow-xl rounded-xl overflow-hidden">
                        <thead class="bg-blue-500 text-white">
                            <tr>
                                <th class="p-3 text-left font-semibold text-sm">JOIN Type</th>
                                <th class="p-3 text-left font-semibold text-sm">Use Case</th>
                                <th class="p-3 text-left font-semibold text-sm">Considerations</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="JOIN Type" class="font-semibold text-blue-800 md:bg-blue-50">Self JOIN</td>
                                <td data-label="Use Case">Comparing rows within the same table</td>
                                <td data-label="Considerations">Need for table aliases to distinguish references</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="JOIN Type" class="font-semibold text-blue-800 md:bg-blue-50">Multiple JOIN Chains</td>
                                <td data-label="Use Case">Connecting multiple tables in a complex schema</td>
                                <td data-label="Considerations">Performance impact, proper indexing crucial</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="JOIN Type" class="font-semibold text-blue-800 md:bg-blue-50">Conditional JOIN</td>
                                <td data-label="Use Case">JOIN based on complex conditions beyond equality</td>
                                <td data-label="Considerations">Can be difficult to optimize, may require indexing strategy changes</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="JOIN Type" class="font-semibold text-blue-800 md:bg-blue-50">Anti-JOIN Pattern</td>
                                <td data-label="Use Case">Finding records that don't have matches in another table</td>
                                <td data-label="Considerations">Use NOT EXISTS or LEFT JOIN with IS NULL appropriately</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h2 class="text-2xl font-bold text-gray-800 mb-4 mt-8">5. Modern SQL Extensions</h2>
                <p class="mb-4 text-gray-600">Advanced SQL features available in modern data warehouse platforms.</p>
                
                <div class="overflow-x-auto">
                    <table class="w-full responsive-table shadow-xl rounded-xl overflow-hidden">
                        <thead class="bg-blue-500 text-white">
                            <tr>
                                <th class="p-3 text-left font-semibold text-sm">Feature</th>
                                <th class="p-3 text-left font-semibold text-sm">Platform</th>
                                <th class="p-3 text-left font-semibold text-sm">Use Case</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Feature" class="font-semibold text-blue-800 md:bg-blue-50">JSON Functions</td>
                                <td data-label="Platform">BigQuery, PostgreSQL, Snowflake</td>
                                <td data-label="Use Case">Querying and manipulating JSON data fields</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Feature" class="font-semibold text-blue-800 md:bg-blue-50">Array Functions</td>
                                <td data-label="Platform">BigQuery, PostgreSQL</td>
                                <td data-label="Use Case">Working with arrays as data types</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Feature" class="font-semibold text-blue-800 md:bg-blue-50">Geospatial Functions</td>
                                <td data-label="Platform">BigQuery, PostgreSQL</td>
                                <td data-label="Use Case">Performing geospatial calculations and operations</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Feature" class="font-semibold text-blue-800 md:bg-blue-50">Time Travel/Point-in-Time</td>
                                <td data-label="Platform">BigQuery, Snowflake, Databricks Delta</td>
                                <td data-label="Use Case">Querying historical data states</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h2 class="text-2xl font-bold text-gray-800 mb-4 mt-8">6. Best Practices & Common Pitfalls</h2>
                <p class="mb-4 text-gray-600">Key practices to follow and mistakes to avoid when writing advanced SQL.</p>
                
                <div class="overflow-x-auto">
                    <table class="w-full responsive-table shadow-xl rounded-xl overflow-hidden">
                        <thead class="bg-blue-500 text-white">
                            <tr>
                                <th class="p-3 text-left font-semibold text-sm">Practice</th>
                                <th class="p-3 text-left font-semibold text-sm">Guidance</th>
                                <th class="p-3 text-left font-semibold text-sm">Impact</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Practice" class="font-semibold text-blue-800 md:bg-blue-50">Use LIMIT for Development</td>
                                <td data-label="Guidance">Always include LIMIT when testing queries to avoid full table scans</td>
                                <td data-label="Impact">Prevents expensive queries during development</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Practice" class="font-semibold text-blue-800 md:bg-blue-50">Explicit Column Selection</td>
                                <td data-label="Guidance">Use specific column names instead of SELECT *</td>
                                <td data-label="Impact">Better performance, maintainability, and schema stability</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Practice" class="font-semibold text-blue-800 md:bg-blue-50">Indexing Strategy</td>
                                <td data-label="Guidance">Analyze query patterns to create effective indexes</td>
                                <td data-label="Impact">Significant performance improvement for common queries</td>
                            </tr>
                            <tr class="md:border-b md:border-gray-200">
                                <td data-label="Practice" class="font-semibold text-blue-800 md:bg-blue-50">Cost-Based Optimization</td>
                                <td data-label="Guidance">Understand how your database optimizer works</td>
                                <td data-label="Impact">Write queries that align with optimizer capabilities</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <div class="card mt-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Common Advanced SQL Patterns</h2>
                
                <h3 class="text-xl font-semibold text-gray-700 mb-2">Pivot/Unpivot Operations</h3>
                <p class="mb-3">Transform rows into columns or vice versa for different analytical perspectives.</p>
                
                <h3 class="text-xl font-semibold text-gray-700 mb-2">Time Series Analysis</h3>
                <p class="mb-3">Analyze data points collected over time sequences, often using window functions.</p>
                
                <h3 class="text-xl font-semibold text-gray-700 mb-2">Cohort Analysis</h3>
                <p class="mb-3">Group and track users or entities based on shared characteristics over time.</p>
                
                <h3 class="text-xl font-semibold text-gray-700 mb-2">Running Calculations</h3>
                <p class="mb-3">Maintain cumulative metrics like running totals, moving averages, and running counts.</p>
            </div>
        </div>
    </main>
    <script src="../js/main.js"></script>
</body>
</html>
